steps:
  - obabel_extract_models_sdf:
      in:
        input_path: ../data/NCIOpen.sdf
        output_sdf_path: '&ligands.sdf'
        first_molecule: "1"
        last_molecule: "1"
        arg1: -r
  - obabel_split_sdf:
      in:
  #      input_path: '*ligands.sdf'
        output_sdf_path: '&ligand.sdf' # Array type
        arg1: -m
  - receptor.yml:
  - dock_ligand.yml: # scatter
  - autodock_vina_filter:
      in:
        input_log_paths: '*vina.log' # NOTE: plural
        docking_score_cutoff: -4.0
        max_num_decoys_per_ligand: 1
        max_num_decoys_total: 1
        input_batch_pdbqt_path: '*ligand_nested_split.pdbqt' # 2D Array type
        #input_batch_pdbqt_path: ~obabel_split_pdbqt/output_pdb_path # Not necessary if using explicit edge
        output_batch_pdbqt_path: '&decoy_ligand.pdbqt'
  - prepare_complex.yml: # scatter

wic:
   graphviz:
     label: Cheminformatics + Docking + Initial Topology Setup
   steps:
     (4, dock_ligand.yml):
       scatter: [dock_ligand__step__1__prepare_ligand_docking.yml___prepare_ligand_docking__step__1__flc.yml___flc__step__1__obgen___input_path]
     (6, prepare_complex.yml):
       scatter: [prepare_complex__step__1__babel_convert___input_path,
                 prepare_complex__step__2__obabel_convert_mol2___input_path]
       scatterMethod: dotproduct
